### WARNING: Current testing not possible with Kyverno CLI v1.5.2. This is a placeholder for a time where the CLI can support the tests.
### See notes in README
name: disallow-capabilities-strict
policies:
  - cpol.yaml
resources:
  - resource.yaml
results:
#################################
## Rule: require-drop-all-pods ##
#################################
###### Pods - Bad
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod01
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod02
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod03
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod04
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod05
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod06
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod07
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod08
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod09
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: badpod10
    kind: Pod
    result: fail
###### Pods - Good
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: goodpod01
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: goodpod02
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: goodpod03
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: goodpod04
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: goodpod05
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: require-drop-all-pods
    resource: goodpod06
    kind: Pod
    result: pass
########################################
## Rule: autogen-require-drop-all-pods ##
########################################
###### Deployments - Bad
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment01
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment02
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment03
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment04
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment05
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment06
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment07
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment08
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment09
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: baddeployment10
    kind: Deployment
    result: fail
###### Deployments - Good
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: gooddeployment01
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: gooddeployment02
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: gooddeployment03
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: gooddeployment04
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: gooddeployment05
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-require-drop-all-pods
    resource: gooddeployment06
    kind: Deployment
    result: pass
#####################################
## Rule: autogen-cronjob-require-drop-all-pods ##
#####################################
###### CronJobs - Bad
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob01
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob02
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob03
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob04
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob05
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob06
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob07
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob08
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob09
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: badcronjob10
    kind: CronJob
    result: fail
###### CronJobs - Good
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: goodcronjob01
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: goodcronjob02
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: goodcronjob03
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: goodcronjob04
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: goodcronjob05
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-require-drop-all-pods
    resource: goodcronjob06
    kind: CronJob
    result: pass
###########################################
## Rule: adding-capabilities-strict-pods ##
###########################################
###### Pods - Bad
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod01
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod02
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod03
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod04
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod05
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod06
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod07
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod08
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod09
    kind: Pod
    result: fail
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-badpod10
    kind: Pod
    result: fail
###### Pods - Good
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod01
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod02
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod03
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod04
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod05
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod06
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod07
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod08
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod09
    kind: Pod
    result: pass
  - policy: disallow-capabilities-strict
    rule: adding-capabilities-strict-pods
    resource: addcap-goodpod10
    kind: Pod
    result: pass
##################################################
## Rule: autogen-adding-capabilities-strict-pods  ##
##################################################
###### Deployments - Bad
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment01
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment02
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment03
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment04
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment05
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment06
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment07
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment08
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment09
    kind: Deployment
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-baddeployment10
    kind: Deployment
    result: fail
###### Deployments - Good
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment01
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment02
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment03
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment04
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment05
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment06
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment07
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment08
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment09
    kind: Deployment
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-adding-capabilities-strict-pods 
    resource: addcap-gooddeployment10
    kind: Deployment
    result: pass
###############################################
## Rule: autogen-cronjob-adding-capabilities-strict-pods  ##
###############################################
###### CronJobs - Bad
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob01
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob02
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob03
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob04
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob05
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob06
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob07
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob08
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob09
    kind: CronJob
    result: fail
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-badcronjob10
    kind: CronJob
    result: fail
###### CronJobs - Good
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob01
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob02
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob03
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob04
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob05
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob06
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob07
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob08
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob09
    kind: CronJob
    result: pass
  - policy: disallow-capabilities-strict
    rule: autogen-cronjob-adding-capabilities-strict-pods 
    resource: addcap-goodcronjob10
    kind: CronJob
    result: pass
