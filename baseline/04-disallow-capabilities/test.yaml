### WARNING: Current testing not possible with Kyverno CLI. This is a placeholder.
### See notes in README
name: disallow-capabilities
policies:
  - cpol.yaml
resources:
  - resource.yaml
results:
###### Pods - Bad
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: badpod01
    kind: Pod
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: badpod02
    kind: Pod
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: badpod03
    kind: Pod
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: badpod04
    kind: Pod
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: badpod05
    kind: Pod
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: badpod06
    kind: Pod
    result: fail
###### Pods - Good
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: goodpod01
    kind: Pod
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: goodpod02
    kind: Pod
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: goodpod03
    kind: Pod
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: goodpod04
    kind: Pod
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: goodpod05
    kind: Pod
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-pods
    resource: goodpod06
    kind: Pod
    result: pass
###### Deployments - Bad
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: baddeployment01
    kind: Deployment
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: baddeployment02
    kind: Deployment
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: baddeployment03
    kind: Deployment
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: baddeployment04
    kind: Deployment
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: baddeployment05
    kind: Deployment
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: baddeployment06
    kind: Deployment
    result: fail
###### Deployments - Good
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: gooddeployment01
    kind: Deployment
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: gooddeployment02
    kind: Deployment
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: gooddeployment03
    kind: Deployment
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: gooddeployment04
    kind: Deployment
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: gooddeployment05
    kind: Deployment
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-controllers
    resource: gooddeployment06
    kind: Deployment
    result: pass
###### CronJobs - Bad
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: badcronjob01
    kind: CronJob
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: badcronjob02
    kind: CronJob
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: badcronjob03
    kind: CronJob
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: badcronjob04
    kind: CronJob
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: badcronjob05
    kind: CronJob
    result: fail
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: badcronjob06
    kind: CronJob
    result: fail
###### CronJobs - Good
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: goodcronjob01
    kind: CronJob
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: goodcronjob02
    kind: CronJob
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: goodcronjob03
    kind: CronJob
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: goodcronjob04
    kind: CronJob
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: goodcronjob05
    kind: CronJob
    result: pass
  - policy: disallow-capabilities
    rule: adding-capabilities-cronjobs
    resource: goodcronjob06
    kind: CronJob
    result: pass
